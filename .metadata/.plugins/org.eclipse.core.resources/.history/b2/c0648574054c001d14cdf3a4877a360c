package email.java_maven.emailjavaMaven;

import java.util.Properties;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;


import java.io.InputStream;

import javax.activation.DataHandler;
import javax.mail.Authenticator;

import javax.mail.PasswordAuthentication;

import javax.mail.util.ByteArrayDataSource;



public class SendEmailTeste_2 {

	public static void main(String[] args) {

		String host = "smtp.gmail.com";
		String from = "b166er1980@gmail.com";
		String to = "criacaoemaildetestecomjava@gmail.com";
		String subject = "Teste envio email";
		String user = "CriacaoEmailDeTesteComJava";
		String password = "CriacaoEmailDeTesteComJava_";
		String sendFile = "SEU_ARQUIVO.txt";
		String html = "<html><head></head><body>   teste </body> </html>";
		String text = "corpo email";
		
		try {
			
			Properties props = new Properties();
            props.put("mail.smtp.host", host);
            props.put("mail.smtp.auth", "true");                    

            Session sessao = Session.getDefaultInstance(props, null);
            sessao.setDebug(false);

            MimeMessage message = new MimeMessage(sessao);

            // From
            message.setFrom(new InternetAddress(from));

            // Subject
            message.setSubject(subject);
            //to
            message.addRecipient(Message.RecipientType.TO, new InternetAddress(to));

            //  texto
            MimeBodyPart plainTextPart = new MimeBodyPart();
            plainTextPart.setContent(text, "text/plain");

            // htmlml 
            MimeBodyPart htmlTextPart = new MimeBodyPart();
            htmlTextPart.setContent(html, "text/html");

            Multipart mp = new MimeMultipart("alternative");

            mp.addBodyPart(plainTextPart);            
            mp.addBodyPart(htmlTextPart);
            FileDataSource fds;
            MimeBodyPart mbp2 = new MimeBodyPart();
            fds = new FileDataSource(sendFile);

            mbp2 = new MimeBodyPart();
            mbp2.setDataHandler(new DataHandler(fds));
            mbp2.setFileName(fds.getName());
            mbp2.setHeader("Content-ID", "imageID");
            mp.addBodyPart(mbp2);

            message.saveChanges();

            Transport transport = sessao.getTransport("smtp");

            transport.connect(host, user, password);

            transport.sendMessage(message, message.getAllRecipients());

            transport.close();
			
		} catch (AddressException a) {
			a.printStackTrace();
		} catch (MessagingException m) {
			m.printStackTrace();
		} catch (Exception ex) {
			ex.printStackTrace();
		}

	}

}
